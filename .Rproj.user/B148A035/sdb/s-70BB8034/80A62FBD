{
    "contents" : "---\ntitle: \"Untitled\"\nauthor: \"Emil H. Andersen & Nguyen Khanh le Ho\"\ndate: \"4 June 2016\"\noutput: pdf_document\n---\n\n```{r MC_Simulation}\nmc.discrete <- function(p,k,n){\n  #------------------------------------Error Handler:--------------------------------------------#\n  # ---------------------------------------------------------------------------------------------#\n  # p is a transition probability matrix                                                         #\n  # k is an integer indicating the initial state of the chain                                    #\n  # n is a natural number indicating the number of simulated steps                               #\n  #----------------------------------------------------------------------------------------------#\n  #p is a matrix with ncol=nrow\n  if(is.list(p) || !is.numeric(p) || !is.matrix(p) || is.vector(p)){\n    stop(\"The given data 'p' must be a numerical matrix.\")\n  } else if(dim(p)[1] != dim(p)[2]){\n    stop(\"The given data 'p' must have the same number of columns and rows.\")\n  } else if(sum(p) != dim(p)[1]){\n    stop(\"The given data 'p' must have summed probability 1 in every row.\")\n  }\n  if(is.matrix(k) || is.list(k) || length(k)!=1){ #Check that k is a single value\n    stop(\"'k' has to be a positive integer; length=1, non-list, non-matrix\")\n  } else if(!is.numeric(k)){ #checks if n is a number\n    stop(\"'k' has to be a positive integer\")\n  } else if(k < 1 || n != round(n) || k > dim(p)[2]){ #checks if k is a natural number inside the transition probability matrix\n    stop(\"'k' has to be a positive integer between 1 and the width/height of the transition probability matrix\")\n  }\n  if(is.matrix(n) || is.list(n) || length(n)!=1){ #Check that n is a single value\n    stop(\"'n' has to be a positive integer; length=1, non-list, non-matrix\")\n  } else if(!is.numeric(n)){ #checks if n is a number\n    stop(\"'n' has to be a positive integer\")\n  } else if(n < 1 || n != round(n)){ #checks if n is a natural number\n    stop(\"'n' has to be a positive integer\")\n  }\n  #---------------------------------------End Error Handler--------------------------------------#\n  width <- dim(p)[2] #Lets us know what the highest number to expect.\n  road <- rep(0,n) #Saves space for the amount of steps we take.\n  va <- runif(n) #We need a random number for each step.\n  for(i in 1:n){ #We need to take n steps.\n    point <- FALSE #Used to check if we found a point\n    j <- 1 #We start from 1, when checking probabilities.\n    while(point == FALSE){ #We have to check up to \"width\" to get a point.\n      if(va[i] <= p[k,j]){ #If the random number corresponds to the probability of that state\n        point = TRUE #We found a point\n        road[i] = j #Save it on the \"road\"\n        k = j #Set our new starting state as the state j we found.\n      } else{ #If the random number is not correct\n        va[i] <- va[i] - p[k,j] #We subtract the probability so that it corresponds to the rest.\n        j <- j + 1 #We check the next probability state.\n      }\n    }\n  }\n  stationary <- rep(0,width) #We need \"width\" numbers to be returned\n  for(i in 1:width){ #We sum the amount of times we were at each state, and divide by number of steps.\n    stationary[i] = sum(road == i)/n\n  }\n  return(stationary) #We return a vector that corresponds to stationary probability of each state in numerical order.\n}\np <- matrix(c(0.2,0.3,0,0,0,0.4,0.7,0,0.5,0,0,0,0,0.7,0,0,0,0,0,0,0.5,0.9,0.25,0,0,0,0,0.1,0.5,0.4,0.1,0,0,0,0.25,0.2),nrow=6,ncol=6)\nk <- 3\nn <- 10000\nprint(mc <- mc.discrete(p,k,n))\n```\n\nWe see that `r mc[1]`\n",
    "created" : 1465299981662.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4046893976",
    "id" : "80A62FBD",
    "lastKnownWriteTime" : 1465310918,
    "path" : "C:/Users/Emil/Dropbox/Universitet/ST522/FinalProjectCombined/Tester/Tester.Rmd",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 7,
    "source_on_save" : false,
    "type" : "r_markdown"
}